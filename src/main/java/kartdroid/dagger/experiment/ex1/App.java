/*
 * This Java source file was generated by the Gradle 'init' task.
 */
package kartdroid.dagger.experiment.ex1;

import kartdroid.dagger.experiment.ex1.di.AppComponent;
import kartdroid.dagger.experiment.ex1.di.DaggerAppComponent;
import kartdroid.dagger.experiment.ex1.di.DataProvider;
import kartdroid.dagger.experiment.ex1.di.module.ManuallyInjectedProviderModule;
import kartdroid.dagger.experiment.ex1.logging.Logger;
import kartdroid.dagger.experiment.ex1.network.NetworkClient;

import javax.inject.Inject;
import java.util.Objects;

public class App {
    private final Logger logger;
    private final NetworkClient networkClient;
    private final ProvidedDependency providedDependency;

    @Inject
    App(Logger logger, NetworkClient networkClient, ProvidedDependency providedDependency) {
        this.logger = logger;
        this.networkClient = networkClient;
        this.providedDependency = providedDependency;
    }

    public void displayGreeting() {
        logger.log("Hello world.");
    }

    public void pingSomeone() {
        networkClient.get("www.dummy.com", (v, e) -> {
            logger.log("value: " + (Objects.nonNull(v) ? new String(v) : "null"));
            logger.log("error: " + e);
        });
    }


    public static void main(String[] args) {
        AppComponent myAppComponent = DaggerAppComponent.builder()
                .manuallyInjectedProviderModule(new ManuallyInjectedProviderModule(new ProvidedDependency()))
                .dataProvider(new DataProvider())
                .build();
        App myApp =  myAppComponent.provideApp();
        myApp.displayGreeting();
        myApp.pingSomeone();
        System.out.println("providedDependency.logger= " + myApp.providedDependency.logger);
        myAppComponent.inject(myApp.providedDependency);
        System.out.println("providedDependency.logger= " + myApp.providedDependency.logger);
    }
}
